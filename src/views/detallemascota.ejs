<%- include("templates/cabecerasignin", {tituloweb: "Detalle mascota"}) %>

<div class="container my-4">
    <h2>Detalle mascota</h1>
        <% if (error) { %>
            <p>
            <%= mensaje %>
            </p>
            <a href="../mismascotas" class="btn btn-dark btn-block">Volver a mis mascotas</a>
        <% } %>

        <% if (!error) { %>
            <table class="table">
                <thead>
                  <tr>
                    <th scope="col">Id</th>
                    <th scope="col">Nombre</th>
                    <th scope="col">Raza</th>
                    <th scope="col">Edad</th>
                    <th scope="col">Genero</th>
                    <th scope="col">Especie</th>
                    <th scope="col">Accion</th>
                  </tr>
                </thead>
                <tbody>
                        <tr>
                            <th scope="row"><%= mascota.id %></th>
                            <td><%= mascota.nombre %></td>
                            <td><%= mascota.raza %></td>
                            <td><%= mascota.edad %></td>
                            <td><%= mascota.genero %></td>
                            <td><%= mascota.especie %></td>
                            <td>
                                <a 
                                    href="actualizar/<%= mascota.id %>"
                                    class="btn btn-info btn-sm"
                                >
                                Actualizar
                                </a>
                                <button
                                class="btn btn-danger btn-sm"
                                id="btnEliminar"
                                data-id="<%= mascota.id %>"
                                >
                                Eliminar
                                </button>
                            </td>
                        </tr>
                </tbody>
            </table>
        <% } %>
</div>

<script>
    const btnEliminar = document.querySelector("#btnEliminar")

    btnEliminar.addEventListener('click', async () => {

        console.log("me diste clic a eliminar")
        const id = btnEliminar.dataset.id
        console.log("id", id)

        try {
            const data = await fetch(`/home/mismascotas/${id}`, {
                method: "delete"
            })
            const res = await data.json()
            if (res.estado) {
                window.location.href = "/home/mismascotas"
            } else {
                console.log(error)    
            }
        } catch (error) {
            console.log(error)
        }
    })
</script>

<%- include("templates/footerhome") %>